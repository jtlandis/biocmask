<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get observations of a vector — vctrs_slice • biocmask</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get observations of a vector — vctrs_slice"><meta property="og:description" content='This extends vctrs::vec_slice to S4Vectors::Vector class by masking
vec_slice with S7::new_generic. Atomic vectors and other base S3 classes
(list, data.frame, factor, Dat, POSIXct) will dispatch to the
vctrs::vec_slice method as normal. Dispatch support on the
S4Vectors::Vector and S4Vectors::DataFrame classes provides a unified
framework for working with base R vectors and S4Vectors.
S4Vectors::Vector Implementation


This method will naively call the [ method for any S4 class that inherits
from the S4Vectors::Vector class. This may not be a very efficient way to
slice up an S4 class, but will work.
With this implementation, the x@mcol data is expected to be retained after
a call to biocmask::vec_slice(x, i).



S4Vectors::DataFrame Implementation


The DataFrame implementation works similar to how vctrs::vec_slice works
on a data.frame object. What is being sliced is the rows of x@listData.
To maintain the size stability of the DataFrame object, we change @nrows
to the appropriate value, and perform a recursive call if @elementMetadata
is not NULL.



Performance


Depending on the size and complexity of your S4 Vector object, you may find
the standard subset operation is extremely slow. For example, consider a
SummarizedExperiment whose rowData contains a CompressedGRangesList
object assigned to the name "exons" and whose length is 250,000 and
underlying @unlistData is length 1,600,000. Performing a by .features
grouping operation and attempting to evaluate the exons within the row
context would force the CompressedGRangesList object to be
chopped element-wise.
Unfortunately, there is a massive performance hit in attempting to construct
250,000 GRanges. Unless you do not mind waiting over an hour for each
dplyr verb in which exons gets evaluated, consider biocmask_s4_proxy_vec().
This attempts to reconstruct certain standard S4Vectors::Vectors as
standard vectors or tibbles. The equivalent exons object would require
much more memory use, but at the advantage of only taking several seconds to
construct.When you are done, you can attempt to restore the original S4
Vector with biocmask_restore_s4_proxy().
biocmask_s4_proxy_vec() is faster to work with because there are less
checks on the object validity and all @elementMetadata and @metadata are
dropped from the objects.

'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biocmask</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/biocmask.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jtlandis/biocmask/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get observations of a vector</h1>
    <small class="dont-index">Source: <a href="https://github.com/jtlandis/biocmask/blob/HEAD/R/vctrs-S4-slice.R" class="external-link"><code>R/vctrs-S4-slice.R</code></a></small>
    <div class="hidden name"><code>vctrs_slice.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This extends <code><a href="https://vctrs.r-lib.org/reference/vec_slice.html" class="external-link">vctrs::vec_slice</a></code> to <code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">S4Vectors::Vector</a></code> class by masking
<code>vec_slice</code> with <code><a href="https://rconsortium.github.io/S7/reference/new_generic.html" class="external-link">S7::new_generic</a></code>. Atomic vectors and other base S3 classes
(list, data.frame, factor, Dat, POSIXct) will dispatch to the
<code><a href="https://vctrs.r-lib.org/reference/vec_slice.html" class="external-link">vctrs::vec_slice</a></code> method as normal. Dispatch support on the
<code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">S4Vectors::Vector</a></code> and <code><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">S4Vectors::DataFrame</a></code> classes provides a unified
framework for working with base R vectors and <code>S4Vectors</code>.</p><div class="section">
<h3 id="s-vectors-vector-implementation"><code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">S4Vectors::Vector</a></code> Implementation<a class="anchor" aria-label="anchor" href="#s-vectors-vector-implementation"></a></h3>


<p>This method will naively call the <code>[</code> method for any S4 class that inherits
from the <code><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">S4Vectors::Vector</a></code> class. This may not be a very efficient way to
slice up an S4 class, but will work.</p>
<p>With this implementation, the <code>x@mcol</code> data is expected to be retained after
a call to <code>biocmask::vec_slice(x, i)</code>.</p>
</div>

<div class="section">
<h3 id="s-vectors-dataframe-implementation"><code><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">S4Vectors::DataFrame</a></code> Implementation<a class="anchor" aria-label="anchor" href="#s-vectors-dataframe-implementation"></a></h3>


<p>The <code>DataFrame</code> implementation works similar to how <code><a href="https://vctrs.r-lib.org/reference/vec_slice.html" class="external-link">vctrs::vec_slice</a></code> works
on a <code>data.frame</code> object. What is being sliced is the rows of <code>x@listData</code>.
To maintain the size stability of the <code>DataFrame</code> object, we change <code>@nrows</code>
to the appropriate value, and perform a recursive call if <code>@elementMetadata</code>
is not <code>NULL</code>.</p>
</div>

<div class="section">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a></h3>


<p>Depending on the size and complexity of your S4 Vector object, you may find
the standard subset operation is extremely slow. For example, consider a
<code>SummarizedExperiment</code> whose rowData contains a <code>CompressedGRangesList</code>
object assigned to the name "exons" and whose length is 250,000 and
underlying <code>@unlistData</code> is length 1,600,000. Performing a by <code>.features</code>
grouping operation and attempting to evaluate the <code>exons</code> within the row
context would force the <code>CompressedGRangesList</code> object to be
chopped element-wise.</p>
<p>Unfortunately, there is a massive performance hit in attempting to construct
250,000 <code>GRanges</code>. Unless you do not mind waiting over an hour for each
<code>dplyr</code> verb in which <code>exons</code> gets evaluated, consider <code>biocmask_s4_proxy_vec()</code>.
This attempts to reconstruct certain standard <code>S4Vectors::Vectors</code> as
standard vectors or tibbles. The equivalent <code>exons</code> object would require
much more memory use, but at the advantage of only taking several seconds to
construct.When you are done, you can attempt to restore the original S4
Vector with <code>biocmask_restore_s4_proxy()</code>.</p>
<p><code>biocmask_s4_proxy_vec()</code> is faster to work with because there are less
checks on the object validity and all <code>@elementMetadata</code> and <code>@metadata</code> are
dropped from the objects.</p>
</div>

    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vec_slice</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>An integer, character or logical vector specifying the
locations or names of the observations to get/set. Specify
<code>TRUE</code> to index all elements (as in <code>x[]</code>), or <code>NULL</code>, <code>FALSE</code> or
<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> to index none (as in <code>x[NULL]</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/jtlandis" class="external-link">Justin Landis</a>, <a href="https://mikelove.github.io" class="external-link">Michael Love</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

